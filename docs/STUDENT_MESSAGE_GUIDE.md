# 學員查看訊息指南 📧

## 🎯 快速步驟

### 1. 登入系統
使用學員（求職者）帳號登入

### 2. 進入課程詳情頁
- 點擊導航欄的「課程列表」
- 選擇**已報名**的課程
- 點擊課程卡片進入詳情頁

### 3. 查看訊息按鈕
在課程詳情頁的右側，應該會看到：

```
┌─────────────────────────────┐
│     NT$ 5000.00             │
├─────────────────────────────┤
│  ✅ 您已註冊此課程          │
│                             │
│  [查看學習進度] ← 第一個按鈕│
│  [查看課程訊息] ← 第二個按鈕│ 📧 點這裡！
└─────────────────────────────┘
```

### 4. 點擊「查看課程訊息」
- 按鈕是藍色的（is-info）
- 有信封圖示 📧
- 點擊後會進入訊息頁面

## 🔍 如果看不到按鈕

### 檢查清單

#### ✅ 1. 確認已報名課程
**問題：** 只有已報名的課程才會顯示「查看課程訊息」按鈕

**檢查方法：**
- 課程詳情頁應該顯示「✅ 您已註冊此課程」
- 如果顯示「立即報名」按鈕，表示尚未報名

**解決方案：**
- 點擊「立即報名」按鈕
- 報名成功後，重新整理頁面
- 應該就能看到「查看課程訊息」按鈕

#### ✅ 2. 檢查瀏覽器 Console
**步驟：**
1. 按 F12 打開開發者工具
2. 切換到 Console 標籤
3. 重新整理頁面
4. 查看是否有錯誤訊息

**預期看到：**
```javascript
[Course Detail] 載入課程...
[Course Detail] 檢查報名狀態...
[Course Detail] 報名狀態: enrolled
```

**如果看到錯誤：**
- 截圖錯誤訊息
- 檢查是否有紅色錯誤

#### ✅ 3. 檢查登入狀態
**問題：** Token 可能過期

**解決方案：**
1. 登出系統
2. 重新登入
3. 再次進入課程詳情頁

#### ✅ 4. 清除瀏覽器快取
**步驟：**
1. 按 Ctrl+Shift+Delete (Windows) 或 Cmd+Shift+Delete (Mac)
2. 選擇「快取的圖片和檔案」
3. 清除快取
4. 重新整理頁面

## 📱 視覺化指南

### 正確的顯示（已報名）

```
課程詳情頁
├── 左側：課程資訊
│   ├── 課程標題
│   ├── 課程描述
│   ├── 課程大綱
│   └── 講師資訊
│
└── 右側：報名區域
    ├── 價格：NT$ 5000.00
    ├── ✅ 您已註冊此課程
    ├── [查看學習進度] 按鈕
    ├── [查看課程訊息] 按鈕 ← 📧 這裡！
    └── 課程特色
```

### 錯誤的顯示（未報名）

```
課程詳情頁
├── 左側：課程資訊
└── 右側：報名區域
    ├── 價格：NT$ 5000.00
    ├── [立即報名] 按鈕 ← ❌ 需要先報名
    └── 課程特色
```

## 🧪 測試步驟

### 測試 1: 檢查報名狀態

1. 登入學員帳號
2. 進入課程詳情頁
3. 按 F12 打開 Console
4. 在 Console 輸入：
   ```javascript
   console.log('isEnrolled:', document.querySelector('.notification.is-success'))
   ```
5. 如果返回 `null`，表示未報名

### 測試 2: 直接訪問訊息頁面

訪問：
```
https://your-domain.pages.dev/courses/1/messages
```

**預期結果：**
- 如果已報名：顯示訊息列表
- 如果未報名：顯示「您尚未報名此課程」

### 測試 3: 檢查資料庫

執行診斷腳本：
```bash
npx tsx src/scripts/check-messages.ts
```

查看：
- 是否有訊息記錄
- 學員是否已報名課程

## 🐛 常見問題

### Q1: 我已經報名了，但看不到「查看課程訊息」按鈕

**可能原因：**
1. 瀏覽器快取問題
2. Token 過期
3. 報名狀態檢查失敗

**解決方案：**
1. 清除快取並重新整理
2. 重新登入
3. 檢查 Console 的錯誤訊息
4. 嘗試直接訪問訊息頁面 URL

### Q2: 點擊「查看課程訊息」後顯示錯誤

**錯誤訊息：** 「您尚未報名此課程」

**解決方案：**
1. 確認真的已報名（檢查資料庫）
2. 檢查 Console 的報名狀態日誌
3. 重新報名課程

### Q3: 訊息頁面是空白的

**可能原因：**
1. 講師還沒發送訊息
2. API 請求失敗
3. JavaScript 錯誤

**解決方案：**
1. 檢查 Console 是否有錯誤
2. 檢查 Network 標籤的 API 請求
3. 確認講師已發送訊息（檢查資料庫）

## 📊 診斷流程圖

```
學員登入
    ↓
進入課程列表
    ↓
選擇課程
    ↓
進入課程詳情頁
    ↓
檢查報名狀態
    ↓
┌─────────────────┬─────────────────┐
│   已報名？      │   未報名？      │
├─────────────────┼─────────────────┤
│ ✅ 顯示：       │ ❌ 顯示：       │
│ • 已註冊提示    │ • 立即報名按鈕  │
│ • 查看進度按鈕  │                 │
│ • 查看訊息按鈕  │ 需要先報名！    │
└─────────────────┴─────────────────┘
         ↓
    點擊「查看課程訊息」
         ↓
    進入訊息頁面
         ↓
┌─────────────────┬─────────────────┐
│   有訊息？      │   沒有訊息？    │
├─────────────────┼─────────────────┤
│ ✅ 顯示訊息列表 │ ℹ️ 顯示：       │
│                 │ 「目前沒有訊息」│
└─────────────────┴─────────────────┘
```

## 💡 開發者調試

### 檢查報名狀態 API

```bash
curl -X GET https://your-domain.pages.dev/api/v1/courses/1/progress \
  -H "Authorization: Bearer YOUR_TOKEN"
```

**預期回應（已報名）：**
```json
{
  "success": true,
  "data": {
    "status": "enrolled",
    "progressPercentage": 0,
    ...
  }
}
```

**預期回應（未報名）：**
```json
{
  "success": true,
  "data": {
    "status": "not_enrolled",
    ...
  }
}
```

### 檢查訊息 API

```bash
curl -X GET https://your-domain.pages.dev/api/v1/courses/1/messages \
  -H "Authorization: Bearer YOUR_TOKEN"
```

**預期回應：**
```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "subject": "訊息主旨",
      "message": "訊息內容",
      ...
    }
  ]
}
```

## 📞 需要幫助？

如果按照以上步驟仍然無法查看訊息，請提供：

1. **截圖**
   - 課程詳情頁的右側區域
   - 瀏覽器 Console 的輸出

2. **資訊**
   - 使用的瀏覽器和版本
   - 是否已報名課程
   - 是否看到「已註冊」提示

3. **測試結果**
   - 執行 `npx tsx src/scripts/check-messages.ts` 的輸出
   - 直接訪問訊息頁面 URL 的結果

---

**最後更新：** 2024-11-13  
**版本：** 1.0
